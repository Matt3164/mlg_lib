---

title: How to train a patch based ML model on FMNIST
keywords: fastai
sidebar: home_sidebar

summary: "Testing patch approaches on FMNIST"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/21_application.patch_trs_on_fmnist.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">fetch_openml</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s2">&quot;Fashion-MNIST&quot;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="s2">&quot;/home/matthieu/sklearn_data&quot;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="n">xtrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">ytest</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 21.7 s, sys: 1.2 s, total: 22.9 s
Wall time: 23 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">mlg_lib.ml_utils</span> <span class="k">import</span> <span class="n">PatchTransform</span><span class="p">,</span> <span class="n">LambdaRow</span>
<span class="kn">from</span> <span class="nn">mlg_lib.imgfeat</span> <span class="k">import</span> <span class="n">flatten</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomTreesEmbedding</span><span class="p">,</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">mlg_lib.ml_utils</span> <span class="k">import</span> <span class="n">sk_train</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">PatchTransform</span><span class="p">(</span><span class="n">transformer</span><span class="o">=</span><span class="n">make_pipeline</span><span class="p">(</span>
                                <span class="n">LambdaRow</span><span class="p">(</span><span class="n">flatten</span><span class="p">),</span>
                                <span class="n">StandardScaler</span><span class="p">(),</span>
                                <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
                            <span class="p">),</span>
               <span class="n">patch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">stride</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">max_patches</span><span class="o">=</span><span class="mi">10</span>
              <span class="p">),</span>
    <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">sk_train</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cm</span><span class="o">=</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>TrainingOutput(model=Pipeline(memory=None,
         steps=[(&#39;patchtransform&#39;,
                 PatchTransform(max_patches=10, patch_size=8, stride=8,
                                transformer=Pipeline(memory=None,
                                                     steps=[(&#39;lambdarow&#39;,
                                                             LambdaRow(row_func=&lt;function flatten at 0x7f75a09d0378&gt;)),
                                                            (&#39;standardscaler&#39;,
                                                             StandardScaler(copy=True,
                                                                            with_mean=True,
                                                                            with_std=True)),
                                                            (&#39;pca&#39;,
                                                             PCA(copy=True,
                                                                 iterated_power=&#39;auto&#39;,
                                                                 n_components=8,
                                                                 random_state...
                 RandomForestClassifier(bootstrap=True, class_weight=None,
                                        criterion=&#39;gini&#39;, max_depth=None,
                                        max_features=&#39;log2&#39;,
                                        max_leaf_nodes=None,
                                        min_impurity_decrease=0.0,
                                        min_impurity_split=None,
                                        min_samples_leaf=1, min_samples_split=2,
                                        min_weight_fraction_leaf=0.0,
                                        n_estimators=100, n_jobs=None,
                                        oob_score=False, random_state=None,
                                        verbose=0, warm_start=False))],
         verbose=False), metrics={&#39;train_cm&#39;: array([[6019,    0,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0, 5964,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0, 5955,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0, 5988,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0, 6028,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0, 6007,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0, 6009,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0, 6003,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0, 6004,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0,    0, 6023]]), &#39;train_acc&#39;: 1.0, &#39;test_cm&#39;: array([[839,   1,  18,  38,   6,   1,  64,   0,  14,   0],
       [  5, 980,   9,  37,   2,   0,   3,   0,   0,   0],
       [  6,   1, 847,  11, 104,   0,  72,   0,   4,   0],
       [ 23,   7,  15, 923,  25,   0,  17,   0,   2,   0],
       [  1,   1,  61,  48, 797,   0,  60,   0,   4,   0],
       [  0,   0,   0,   0,   0, 945,   0,  37,   2,   9],
       [174,   1, 122,  34,  93,   0, 554,   0,  13,   0],
       [  0,   0,   0,   0,   0,  33,   0, 927,   2,  35],
       [  4,   0,   7,   8,   4,   4,  10,   1, 955,   3],
       [  0,   0,   0,   0,   0,  15,   0,  37,   0, 925]]), &#39;test_acc&#39;: 0.8692})
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">PatchTransform</span><span class="p">(</span><span class="n">transformer</span><span class="o">=</span><span class="n">make_pipeline</span><span class="p">(</span>
                                <span class="n">LambdaRow</span><span class="p">(</span><span class="n">flatten</span><span class="p">),</span>
                                <span class="n">RandomTreesEmbedding</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                            <span class="p">),</span>
               <span class="n">patch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">stride</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">max_patches</span><span class="o">=</span><span class="mi">4</span>
              <span class="p">),</span>
    <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 525 µs, sys: 26 µs, total: 551 µs
Wall time: 562 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">sk_train</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cm</span><span class="o">=</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 11min 53s, sys: 2.56 s, total: 11min 56s
Wall time: 11min 56s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>TrainingOutput(model=Pipeline(memory=None,
         steps=[(&#39;patchtransform&#39;,
                 PatchTransform(max_patches=4, patch_size=8, stride=8,
                                transformer=Pipeline(memory=None,
                                                     steps=[(&#39;lambdarow&#39;,
                                                             LambdaRow(row_func=&lt;function flatten at 0x7f99d85cd950&gt;)),
                                                            (&#39;randomtreesembedding&#39;,
                                                             RandomTreesEmbedding(max_depth=2,
                                                                                  max_leaf_nodes=None,
                                                                                  min_impurity_decrease=0.0,
                                                                                  min_impurity_split=None,
                                                                                  min_samples_leaf=1...
                 RandomForestClassifier(bootstrap=True, class_weight=None,
                                        criterion=&#39;gini&#39;, max_depth=None,
                                        max_features=&#39;log2&#39;,
                                        max_leaf_nodes=None,
                                        min_impurity_decrease=0.0,
                                        min_impurity_split=None,
                                        min_samples_leaf=1, min_samples_split=2,
                                        min_weight_fraction_leaf=0.0,
                                        n_estimators=100, n_jobs=-1,
                                        oob_score=False, random_state=None,
                                        verbose=0, warm_start=False))],
         verbose=False), metrics={&#39;train_cm&#39;: array([[6019,    0,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0, 5964,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0, 5955,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0, 5988,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0, 6028,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0, 6007,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0, 6009,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0, 6003,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0, 6004,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0,    0, 6023]]), &#39;train_acc&#39;: 1.0, &#39;test_cm&#39;: array([[827,   0,  24,  47,   9,   2,  55,   0,  17,   0],
       [  5, 978,   8,  39,   3,   0,   3,   0,   0,   0],
       [ 12,   0, 804,  11, 134,   1,  72,   0,  11,   0],
       [ 24,   6,  19, 912,  27,   0,  22,   0,   1,   1],
       [  3,   1,  78,  45, 747,   0,  89,   0,   9,   0],
       [  0,   0,   0,   0,   0, 899,   0,  66,   3,  25],
       [199,   1, 157,  36, 103,   0, 468,   0,  27,   0],
       [  0,   0,   0,   0,   0,  53,   0, 889,   4,  51],
       [  1,   0,   6,   7,   4,   5,  10,   2, 958,   3],
       [  0,   0,   0,   0,   0,  21,   0,  35,   1, 920]]), &#39;test_acc&#39;: 0.8402})
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">Normalizer</span><span class="p">,</span> <span class="n">FunctionTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span>

<span class="k">def</span> <span class="nf">_relu</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">PatchTransform</span><span class="p">(</span><span class="n">transformer</span><span class="o">=</span><span class="n">make_pipeline</span><span class="p">(</span>
                                <span class="n">LambdaRow</span><span class="p">(</span><span class="n">flatten</span><span class="p">),</span>
                                <span class="n">Normalizer</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">),</span>
                                <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
                                <span class="n">StandardScaler</span><span class="p">(),</span>
                                <span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">_relu</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                            <span class="p">),</span>
               <span class="n">patch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">stride</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
               <span class="n">max_patches</span><span class="o">=</span><span class="mi">4</span>
              <span class="p">),</span>
    <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 394 µs, sys: 10 µs, total: 404 µs
Wall time: 411 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">sk_train</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cm</span><span class="o">=</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 6min 24s, sys: 1min 26s, total: 7min 51s
Wall time: 4min 47s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>TrainingOutput(model=Pipeline(memory=None,
         steps=[(&#39;patchtransform&#39;,
                 PatchTransform(max_patches=4, patch_size=8, stride=8,
                                transformer=Pipeline(memory=None,
                                                     steps=[(&#39;lambdarow&#39;,
                                                             LambdaRow(row_func=&lt;function flatten at 0x7f99d85cd950&gt;)),
                                                            (&#39;normalizer&#39;,
                                                             Normalizer(copy=True,
                                                                        norm=&#39;l2&#39;)),
                                                            (&#39;kmeans&#39;,
                                                             KMeans(algorithm=&#39;auto&#39;,
                                                                    copy_x=True,
                                                                    init=&#39;k-means++&#39;,
                                                                    max_iter=100,
                                                                    n_clusters=100,
                                                                    n_init=...
                 RandomForestClassifier(bootstrap=True, class_weight=None,
                                        criterion=&#39;gini&#39;, max_depth=None,
                                        max_features=&#39;log2&#39;,
                                        max_leaf_nodes=None,
                                        min_impurity_decrease=0.0,
                                        min_impurity_split=None,
                                        min_samples_leaf=1, min_samples_split=2,
                                        min_weight_fraction_leaf=0.0,
                                        n_estimators=100, n_jobs=-1,
                                        oob_score=False, random_state=None,
                                        verbose=0, warm_start=False))],
         verbose=False), metrics={&#39;train_cm&#39;: array([[6019,    0,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0, 5964,    0,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0, 5955,    0,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0, 5988,    0,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0, 6028,    0,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0, 6007,    0,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0, 6009,    0,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0, 6003,    0,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0, 6004,    0],
       [   0,    0,    0,    0,    0,    0,    0,    0,    0, 6023]]), &#39;train_acc&#39;: 1.0, &#39;test_cm&#39;: array([[840,   3,  10,  28,   9,   0,  81,   0,  10,   0],
       [  3, 984,   5,  36,   1,   0,   7,   0,   0,   0],
       [  6,   3, 794,  12, 140,   1,  83,   0,   6,   0],
       [ 22,   7,  11, 929,  27,   0,  15,   0,   0,   1],
       [  0,   1,  65,  56, 756,   0,  90,   0,   4,   0],
       [  0,   0,   0,   0,   0, 923,   0,  56,   3,  11],
       [183,   2, 113,  34,  90,   0, 551,   0,  18,   0],
       [  0,   0,   0,   0,   0,  27,   0, 927,   3,  40],
       [  4,   1,   3,   4,   7,   3,   7,   1, 964,   2],
       [  0,   0,   0,   0,   0,  12,   0,  34,   0, 931]]), &#39;test_acc&#39;: 0.8599})
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

